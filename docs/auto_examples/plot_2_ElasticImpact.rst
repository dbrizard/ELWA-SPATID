
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plot_2_ElasticImpact.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_plot_2_ElasticImpact.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_2_ElasticImpact.py:


Compare :class:`ElasticImpact` and :class:`WP2`
===============================================
In the case of the impact of an elastic striker on a bar, compare the analytical
result given by :class:`ElasticImpact` and the numerical result computed with
:class:`WP2`.

.. GENERATED FROM PYTHON SOURCE LINES 10-16

.. code-block:: default


    import numpy as np
    import matplotlib.pyplot as plt
    from prop1D import WP2, Barhete, ElasticImpact









.. GENERATED FROM PYTHON SOURCE LINES 17-18

Define material parameters

.. GENERATED FROM PYTHON SOURCE LINES 18-25

.. code-block:: default

    E = 201e9  # Young modulus [Pa]
    rho = 7800  # Density [kg/m3]
    d1 = 0.02  # bar/stricker diameter [m]
    d2 = 0.03  # bar/stricker diameter [m]
    L = 1.  # length of the striker [m]
    Vo = 5.  # intial striker velocity [m/s]








.. GENERATED FROM PYTHON SOURCE LINES 26-33

Analytical result with :class:`ElasticImpact`
---------------------------------------------
Three possible cases:

1. striker and bar have the same diameter
2. striker smaller than bar
3. striker larger than bar

.. GENERATED FROM PYTHON SOURCE LINES 33-52

.. code-block:: default

    time = np.linspace(-10e-6, 10e-3, num=1000)

    EI = ElasticImpact(E, rho, d1, L, Vo)
    EI.computeImpact(time)  # time array must be given to the method
    EI.plotForce('compare', label='ds=db')

    EJ = ElasticImpact(E, rho, d=[d1, d2])
    EJ.computeImpact(time)
    EJ.plotForce('compare', label='ds<db')

    EK = ElasticImpact(E, rho, d=[d2, d1])
    EK.computeImpact(time)
    EK.plotForce('compare', label='ds>db')
    _ = plt.legend()

    EK.plotRn()  # plot amplitude of successive steps






.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_2_ElasticImpact_001.png
         :alt: plot 2 ElasticImpact
         :srcset: /auto_examples/images/sphx_glr_plot_2_ElasticImpact_001.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_2_ElasticImpact_002.png
         :alt: plot 2 ElasticImpact
         :srcset: /auto_examples/images/sphx_glr_plot_2_ElasticImpact_002.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    comment calculer l'eq. 35 pour un choc viscoelastique??
    comment calculer l'eq. 35 pour un choc viscoelastique??
    comment calculer l'eq. 35 pour un choc viscoelastique??
    Ã§a va pas !!




.. GENERATED FROM PYTHON SOURCE LINES 53-56

Numerical result with :class:`WP2`
----------------------------------
Bar configuration: one striker and one bar at rest

.. GENERATED FROM PYTHON SOURCE LINES 56-62

.. code-block:: default

    striker = Barhete([E, E], [rho, rho], [L, .2], [d2, d1], nmin=6)
    testk = WP2(striker, nstep=400, left='free', right='infinite', Vinit=Vo)
    testk.plot('striker')






.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_2_ElasticImpact_003.png
         :alt: Force [N]
         :srcset: /auto_examples/images/sphx_glr_plot_2_ElasticImpact_003.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_2_ElasticImpact_004.png
         :alt: Velocity [m/s]
         :srcset: /auto_examples/images/sphx_glr_plot_2_ElasticImpact_004.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_2_ElasticImpact_005.png
         :alt: Displacement [m]
         :srcset: /auto_examples/images/sphx_glr_plot_2_ElasticImpact_005.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Setting initial velocity of first segment (Vo=5)




.. GENERATED FROM PYTHON SOURCE LINES 63-64

Get force at at impacted side of the bar

.. GENERATED FROM PYTHON SOURCE LINES 64-67

.. code-block:: default

    f1, v1, x1, ind1 = testk.getSignal(x=0, iseg=1, plot=True)





.. image-sg:: /auto_examples/images/sphx_glr_plot_2_ElasticImpact_006.png
   :alt: x = 0 m
   :srcset: /auto_examples/images/sphx_glr_plot_2_ElasticImpact_006.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 68-70

Compare analytical and numerical solutions
------------------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 70-75

.. code-block:: default

    plt.figure()
    plt.plot(testk.time, f1, '-', label='num')
    plt.plot(time, -EK.force, '--', label='ana')
    plt.legend()
    plt.xlim(xmax=2.7e-3)



.. image-sg:: /auto_examples/images/sphx_glr_plot_2_ElasticImpact_007.png
   :alt: plot 2 ElasticImpact
   :srcset: /auto_examples/images/sphx_glr_plot_2_ElasticImpact_007.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    (-0.0005105, 0.0027)




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  2.946 seconds)


.. _sphx_glr_download_auto_examples_plot_2_ElasticImpact.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_2_ElasticImpact.py <plot_2_ElasticImpact.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_2_ElasticImpact.ipynb <plot_2_ElasticImpact.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
