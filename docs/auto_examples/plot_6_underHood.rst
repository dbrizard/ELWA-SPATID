
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plot_6_underHood.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_plot_6_underHood.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_6_underHood.py:


Under the hood
==============
What happens behind the scene to compute the wave propagation in rods.

Two cases are considered:

* :class:`Waveprop` considers a single rod (with section change);
* :class:`WP2` considers several rods in contact. 

:class:`Waveprop` was the first implementation from the work of Bacon 1993. 
It was kept as it allows faster testing of new features since the computation
of the state of the bar is done internally, whereas this is done externally 
in the case of :class:`WP2` (see below :class:`Segment`).

.. GENERATED FROM PYTHON SOURCE LINES 18-28

.. code-block:: default


    import numpy as np
    import matplotlib.pyplot as plt
    from elwaspatid import Waveprop, WP2, BarSingle, BarSet 

    E = 210e9  # [MPa]
    rho = 7800  # [kg/m3]
    L = 1  # [m]
    d = 0.02  # [m]








.. GENERATED FROM PYTHON SOURCE LINES 29-41

Wave propagation with :class:`Waveprop`
---------------------------------------
Bar configuration: one bar at rest with an incident wave.
Indeed, :class:`Waveprop` eats a single :class:`BarSingle` continuous rod and
computes internally the propagation of force and velocity along the rod
and as time increases. 

Since there is no contact interface (single rod), the implementation from 
the work of Bacon 1993 is straightforward. For each time step:
1. compute the force and velocity at the left and right ends; 
2. compute the force and velocity in themiddle of the bar  (see :meth:`Waveprop.__init__`).
All the force values can fill a single matrix, ditto for the velocities.

.. GENERATED FROM PYTHON SOURCE LINES 41-52

.. code-block:: default


    D = np.linspace(0.5, 4, 40)*d  # bar with linearly increasing diamter
    bb = BarSingle(dx=0.01, d=D, E=E, rho=rho)

    incw = np.zeros(80)  # incident wave
    incw[0:20] = 1  # >0 means traction pulse
    test = Waveprop(bb, incw, nstep=2*len(incw), left='free', right='free')

    test.plot()  # plot Force and Velocity space-time diagrams
    bb.plot(typ='DZ')  # plot discretization of the bar and impedance




.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_6_underHood_001.png
         :alt: Force [N]
         :srcset: /auto_examples/images/sphx_glr_plot_6_underHood_001.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_6_underHood_002.png
         :alt: Particule velocity [m/s]
         :srcset: /auto_examples/images/sphx_glr_plot_6_underHood_002.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_6_underHood_003.png
         :alt: plot 6 underHood
         :srcset: /auto_examples/images/sphx_glr_plot_6_underHood_003.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_6_underHood_004.png
         :alt: plot 6 underHood
         :srcset: /auto_examples/images/sphx_glr_plot_6_underHood_004.png
         :class: sphx-glr-multi-img





.. GENERATED FROM PYTHON SOURCE LINES 53-57

.. figure:: ../_static/Bacon1993_Figure2.png
   :scale: 50%

   Discretization of the rod in elements (from [Bacon 1993])

.. GENERATED FROM PYTHON SOURCE LINES 59-69

Wave propagation with :class:`WP2`
----------------------------------
:class:`WP2` allows several rods in contact, which means compression crosses
the contact interface whereas traction cannot cross the contact interface and 
is therefore reflected.

Since we consider several rods in contact, the velocity is discontinuous along
the propagation axis. Hence, force and velocity cannot be computed globally
and must be evaluated for each rod. Each rod stores force and velocity in two
matrices. 

.. GENERATED FROM PYTHON SOURCE LINES 69-75

.. code-block:: default


    # Bar configuration: one striker with initial velocity and one bar at rest
    bar = BarSet([E, E], [rho, rho], [L, 0.5*L], [d, 0.8*d], nmin=6)
    testk = WP2(bar, nstep=200, left='free', right='infinite', Vinit=5)
    testk.plot()




.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_6_underHood_005.png
         :alt: Force [N]
         :srcset: /auto_examples/images/sphx_glr_plot_6_underHood_005.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_6_underHood_006.png
         :alt: Velocity [m/s]
         :srcset: /auto_examples/images/sphx_glr_plot_6_underHood_006.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_6_underHood_007.png
         :alt: Displacement [m]
         :srcset: /auto_examples/images/sphx_glr_plot_6_underHood_007.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Setting initial velocity of first segment (Vo=5)




.. GENERATED FROM PYTHON SOURCE LINES 76-79

Internally, the bar :class:`BarSet` contains a list of :class:`Segment`, one
for each independant rod. Each :class:`Segment` has been discretized in ``nX``
elements along the propagation axis.

.. GENERATED FROM PYTHON SOURCE LINES 79-81

.. code-block:: default

    print(bar.seg)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    [
    L: 1 m
    Z: ['12714.7'] kg/s
    Left: impact
    Right: interf
    nX: 13
    , 
    L: 0.5 m
    Z: ['8137.42'] kg/s
    Left: interf
    Right: free
    nX: 7
    ]




.. GENERATED FROM PYTHON SOURCE LINES 82-92

:class:`Segment` has the following methods:

- :meth:`Segment.initCalc`
- :meth:`Segment.compMiddle`
- :meth:`Segment.compLeft`
- :meth:`Segment.compRight`

These methods are called by :meth:`WP2.__init__` which, while looping over time,
iterates on all the :class:`Segment` in the list provided by :class:`BarSet` to
compute the state (Force, Velocity) of all the elements of each :class:`Segment`.

.. GENERATED FROM PYTHON SOURCE LINES 94-95

XXX a word on :class:`Bar`, used in :class:`BarSet`

.. GENERATED FROM PYTHON SOURCE LINES 95-96

.. code-block:: default

    bar.bar_continuous.plot()



.. image-sg:: /auto_examples/images/sphx_glr_plot_6_underHood_008.png
   :alt: plot 6 underHood
   :srcset: /auto_examples/images/sphx_glr_plot_6_underHood_008.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  2.919 seconds)


.. _sphx_glr_download_auto_examples_plot_6_underHood.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_6_underHood.py <plot_6_underHood.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_6_underHood.ipynb <plot_6_underHood.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
