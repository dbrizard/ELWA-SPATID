
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plot_0_Waveprop.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_plot_0_Waveprop.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_0_Waveprop.py:


Test :class:`Waveprop` class
============================

Define a :class:`Barhomo` bar and use it with :class:`Waveprop` to compute
elastic wave propagation in simple test cases.

.. GENERATED FROM PYTHON SOURCE LINES 8-17

.. code-block:: default


    # sphinx_gallery_thumbnail_number = 5

    import matplotlib.pyplot as plt
    import numpy as np

    from prop1D import Waveprop, Barhomo, trapezeWave









.. GENERATED FROM PYTHON SOURCE LINES 18-19

Define material and geometrical parameters

.. GENERATED FROM PYTHON SOURCE LINES 19-24

.. code-block:: default

    E = 201e9  # Young modulus [Pa]
    rho = 7800  # Density [kg/m3]
    d = 0.020  # diameter [m]
    k = 2.4  # diamters ratio [-]








.. GENERATED FROM PYTHON SOURCE LINES 25-26

Define the incident wave vector

.. GENERATED FROM PYTHON SOURCE LINES 26-31

.. code-block:: default


    incw = np.zeros(80)  # incident wave
    incw[0:20] = 1  # >0 means traction pulse









.. GENERATED FROM PYTHON SOURCE LINES 32-33

Create the bars

.. GENERATED FROM PYTHON SOURCE LINES 33-48

.. code-block:: default

    dx = 0.01  # length of an elementary Segment [m]
    n = 50  # number of Segments [-]
    D = np.ones(n) * d  # diameters of the Segments
    bb = Barhomo(dx, D, E, rho)  # constant section bar
    D2 = np.hstack((np.ones(n)*d, np.ones(n)*d*k))  # section change 
    b2 = Barhomo(dx, D2, E, rho)  # cross-section increase
    b3 = Barhomo(dx, D2[::-1], E, rho)  # cross-secction reduction

    # Visualize the bar:
    bb.plot()  # constant cross-section and constant impedance
    b2.plot()  # cross-section and impedance increase

    ## Cas test SANS coupures (barhomo)
    # premier cas test avec une barre uniforme




.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_001.png
         :alt: plot 0 Waveprop
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_001.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_002.png
         :alt: plot 0 Waveprop
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_002.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_003.png
         :alt: plot 0 Waveprop
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_003.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_004.png
         :alt: plot 0 Waveprop
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_004.png
         :class: sphx-glr-multi-img





.. GENERATED FROM PYTHON SOURCE LINES 49-56

Free-free uniform bar
---------------------
Incident pulse reflects on both end of the bar endlessly.
The force at both ends of the bar is null. Traction pulse reflects as compression.

It is also possible to plot cuts of the space-time diagram, at a given time `t`
or at a given position `x`

.. GENERATED FROM PYTHON SOURCE LINES 56-65

.. code-block:: default


    test = Waveprop(bb, incw, nstep=2*len(incw), left='free', right='free')
    test.plot()

    test.plot(typ='DX')  # Wave direction (D) and Displacement (X)
    test.plotcut(x=bb.x[int(n/2)])
    test.plotcut(t=bb.dt*len(incw)/2)





.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_005.png
         :alt: Force [N]
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_005.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_006.png
         :alt: Particule velocity [m/s]
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_006.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_007.png
         :alt: Wave direction (left or righ)
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_007.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_008.png
         :alt: Displacement [m]
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_008.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_009.png
         :alt: x=0.25 m
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_009.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_010.png
         :alt: t=7.87969e-05 s
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_010.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    this may not be a Barhete instance, no vertical lines to plot
    this may not be a Barhete instance, no vertical lines to plot
    this may not be a Barhete instance, no vertical lines to plot
    this may not be a Barhete instance, no vertical lines to plot




.. GENERATED FROM PYTHON SOURCE LINES 66-69

Infinite-infinite uniform bar
---------------------------
Infinite end amounts to anechoic condition: no reflecion of elastic wave.

.. GENERATED FROM PYTHON SOURCE LINES 69-72

.. code-block:: default

    testf = Waveprop(bb, incw, nstep=100, left='infinite', right='infinite')
    testf.plot()




.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_011.png
         :alt: Force [N]
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_011.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_012.png
         :alt: Particule velocity [m/s]
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_012.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    this may not be a Barhete instance, no vertical lines to plot
    this may not be a Barhete instance, no vertical lines to plot




.. GENERATED FROM PYTHON SOURCE LINES 73-75

Free-free bar with section increase
-----------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 75-78

.. code-block:: default

    testa = Waveprop(b2, incw, nstep=170, left='free', right='free')
    testa.plot()




.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_013.png
         :alt: Force [N]
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_013.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_014.png
         :alt: Particule velocity [m/s]
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_014.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    this may not be a Barhete instance, no vertical lines to plot
    this may not be a Barhete instance, no vertical lines to plot




.. GENERATED FROM PYTHON SOURCE LINES 79-81

Free-free bar with section reduction
------------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 81-85

.. code-block:: default

    testd = Waveprop(b3, incw, nstep=170, left='free', right='free')
    testd.plot()





.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_015.png
         :alt: Force [N]
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_015.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_016.png
         :alt: Particule velocity [m/s]
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_016.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    this may not be a Barhete instance, no vertical lines to plot
    this may not be a Barhete instance, no vertical lines to plot




.. GENERATED FROM PYTHON SOURCE LINES 86-93

Whatever pulse input is possible
--------------------------------
Trapeze
^^^^^^^
For exemple, define a trapeze pulse shape and propagate it in a bar with 
constant section. Right end is ``free`` so the traction wave is reflected as
a compression wave. Left end is ``infinite`` so no reflecion occur.

.. GENERATED FROM PYTHON SOURCE LINES 93-99

.. code-block:: default

    trap = trapezeWave(plateau=5, rise=5)
    testt = Waveprop(bb, trap, nstep=120, left='infinite', right='free')
    testt.plot()
    testt.plotcut(x=0.2)





.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_017.png
         :alt: Force [N]
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_017.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_018.png
         :alt: Particule velocity [m/s]
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_018.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_019.png
         :alt: x=0.2 m
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_019.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    this may not be a Barhete instance, no vertical lines to plot
    this may not be a Barhete instance, no vertical lines to plot




.. GENERATED FROM PYTHON SOURCE LINES 100-102

And why not a sine pulse?
^^^^^^^^^^^^^^^^^^^^^^^^^

.. GENERATED FROM PYTHON SOURCE LINES 102-117

.. code-block:: default


    sine = np.sin(2*np.pi*np.linspace(0, 1, num=40))
    bar = Barhomo(dx, np.ones(30)*d, E, rho)
    tests = Waveprop(bar, sine, nstep=3*len(sine), left='infinite', right='free')
    tests.plot()
    tests.plotcut(x=0.15)
    tests.plotcut(x=0.20)

    # inc = np.ones(int(np.rint(100e-6/plic.dt)))  # 100µs excitation
    # # config proche SHPB
    # essai = Waveprop(plic, inc, nstep=3000)
    # essai.plot()  # c'est pas bon, la traction franchis les interfaces !!!
    # essai.plotcut(x=3)
    # essai.plotcut(x=2.01)




.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_020.png
         :alt: Force [N]
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_020.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_021.png
         :alt: Particule velocity [m/s]
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_021.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_022.png
         :alt: x=0.15 m
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_022.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_0_Waveprop_023.png
         :alt: x=0.2 m
         :srcset: /auto_examples/images/sphx_glr_plot_0_Waveprop_023.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    this may not be a Barhete instance, no vertical lines to plot
    this may not be a Barhete instance, no vertical lines to plot





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  7.736 seconds)


.. _sphx_glr_download_auto_examples_plot_0_Waveprop.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_0_Waveprop.py <plot_0_Waveprop.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_0_Waveprop.ipynb <plot_0_Waveprop.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
